<?xml version="1.0" encoding="utf-8"?>
<root xmlns:android="http://schemas.android.com/apk/res/android">

	<!--<gradleScript>
		<![CDATA[
        // Groovy script to attempt modifying settings.gradle
        def settingsFile = file('settings.gradle')
        def customSettings = """
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url 'https://jitpack.io' }
    }
}
"""
        settingsFile.append(customSettings)
        ]]>
	</gradleScript>-->
	<buildGradleAdditions>
		<insert>
			//TestLib_APL.xml -- START
			dependencies {
			implementation('androidx.appcompat:appcompat:1.4.1')
			implementation('androidx.work:work-runtime:2.4.0')
			implementation ('androidx.multidex:multidex:2.0.1')
			implementation ('com.google.android.material:material:1.5.0')
			implementation ('androidx.constraintlayout:constraintlayout:2.1.3')

			}
			//TestLib_APL.xml -- STOP
		</insert>
	</buildGradleAdditions>
	<gradleProperties>
		<insert>
			android.useAndroidX=true
			android.enableJetifier=true
		</insert>
		
	</gradleProperties>
	<init>
		<log text="[SJL] Plugin_APL INIT"/>
	</init>
	<baseBuildGradleAdditions>
		<insert>
			
			allprojects {

			repositories {
			maven { url 'https://jitpack.io' }
			google()
			mavenCentral()
			}
			def mappings = [
			'android.support.annotation': 'androidx.annotation',
			'android.arch.lifecycle': 'androidx.lifecycle',
			'android.support.v4.app.NotificationCompat': 'androidx.core.app.NotificationCompat',
			'android.support.v4.app.ActivityCompat': 'androidx.core.app.ActivityCompat',
			'android.support.v4.content.ContextCompat': 'androidx.core.content.ContextCompat',
			'android.support.v13.app.FragmentCompat': 'androidx.legacy.app.FragmentCompat',
			'android.arch.lifecycle.Lifecycle': 'androidx.lifecycle.Lifecycle',
			'android.arch.lifecycle.LifecycleObserver': 'androidx.lifecycle.LifecycleObserver',
			'android.arch.lifecycle.OnLifecycleEvent': 'androidx.lifecycle.OnLifecycleEvent',
			'android.arch.lifecycle.ProcessLifecycleOwner': 'androidx.lifecycle.ProcessLifecycleOwner',
			]

			beforeEvaluate { project ->
			project.rootProject.projectDir.traverse(type: groovy.io.FileType.FILES, nameFilter: ~/.*\.java$/) { f ->
			mappings.each { entry ->
			if (f.getText('UTF-8').contains(entry.key)) {
			println "Updating ${entry.key} to ${entry.value} in file ${f}"
			ant.replace(file: f, token: entry.key, value: entry.value)
			}
			}
			}
			}
			}
		</insert>
	</baseBuildGradleAdditions>
	<proguardAdditions>
		<insert>
		</insert>
	</proguardAdditions>

	<resourceCopies>
		<copyFile  src = "$S(PluginDir)/../../Libs/TestLib.jar"  dst = "$S(BuildDir)/libs/TestLib.jar" />
	</resourceCopies>

	<gameActivityImportAdditions>
		<insert>
			import com.MeToo.testlib.*;
			import android.Manifest;
			import android.annotation.SuppressLint;
			import android.bluetooth.BluetoothAdapter;
			import android.bluetooth.BluetoothDevice;
			import android.bluetooth.BluetoothGatt;
			import android.bluetooth.BluetoothGattCallback;
			import android.bluetooth.BluetoothGattCharacteristic;
			import android.bluetooth.BluetoothGattDescriptor;
			import android.bluetooth.BluetoothGattServer;
			import android.bluetooth.BluetoothGattServerCallback;
			import android.bluetooth.BluetoothGattService;
			import android.bluetooth.BluetoothManager;
			import android.bluetooth.BluetoothProfile;
			import android.bluetooth.le.AdvertiseCallback;
			import android.bluetooth.le.AdvertiseData;
			import android.bluetooth.le.AdvertiseSettings;
			import android.bluetooth.le.BluetoothLeAdvertiser;
			import android.bluetooth.le.BluetoothLeScanner;
			import android.bluetooth.le.ScanCallback;
			import android.bluetooth.le.ScanFilter;
			import android.bluetooth.le.ScanResult;
			import android.bluetooth.le.ScanSettings;
			import android.content.BroadcastReceiver;
			import android.content.Context;
			import android.content.Intent;
			import android.content.IntentFilter;
			import android.content.pm.PackageManager;
			import android.net.wifi.p2p.WifiP2pManager;
			import android.os.Build;
			import android.os.Bundle;
			import android.os.Handler;
			import android.os.ParcelUuid;
			import android.view.MotionEvent;
			import android.view.View;
			import android.widget.ArrayAdapter;
			import android.widget.Button;
			import android.widget.EditText;
			import android.widget.LinearLayout;
			import android.widget.ListView;
			import android.widget.ScrollView;
			import android.widget.TextView;
			import androidx.activity.result.ActivityResultLauncher;
			import androidx.activity.result.contract.ActivityResultContracts;
			import androidx.appcompat.app.AppCompatActivity;
			import androidx.core.app.ActivityCompat;
			import androidx.core.content.ContextCompat;
			import java.nio.charset.Charset;
			import java.nio.charset.StandardCharsets;
			import java.util.ArrayList;
			import java.util.Arrays;
			import java.util.HashMap;
			import java.util.List;
			import java.util.Map;
			import java.util.UUID;
		</insert>
	</gameActivityImportAdditions>
	<gameActivityClassAdditions>
		<insert>
			public void TestFunc() {
			TestClass.TestFunc();
			nativeTestFunc(999);

			TestClass.showToast(GameActivity.this);
			//runOnUiThread(new Runnable() {
			//@Override
			//public void run() {
			//Toast.makeText(GameActivity.this, "Bluetooth permissions granted", Toast.LENGTH_SHORT).show();
			//}
			//});
			}
			public native void nativeTestFunc(int value);
		</insert>
	</gameActivityClassAdditions>
</root>